var FlatfileImporter=function(){"use strict";var d="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function e(e,t){return e(t={exports:{}},t.exports),t.exports}function t(e){if(arguments.length<1)throw new TypeError("1 argument is required");if("object"!=typeof e)throw new TypeError("Argument 1 (”other“) to Node.contains must be an instance of Node");var t=e;do{if(this===t)return!0}while(t=t&&t.parentNode);return!1}e(function(e,t){!function(){function e(t){var n=this.constructor;return this.then(function(e){return n.resolve(t()).then(function(){return e})},function(e){return n.resolve(t()).then(function(){return n.reject(e)})})}function t(n){return new this(function(o,e){if(!n||void 0===n.length)return e(new TypeError(typeof n+" "+n+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var i=Array.prototype.slice.call(n);if(0===i.length)return o([]);var a=i.length;for(var t=0;t<i.length;t++)!function t(n,e){if(e&&("object"==typeof e||"function"==typeof e)){var r=e.then;if("function"==typeof r)return void r.call(e,function(e){t(n,e)},function(e){i[n]={status:"rejected",reason:e},0==--a&&o(i)})}i[n]={status:"fulfilled",value:e},0==--a&&o(i)}(t,i[t])})}var n=setTimeout;function u(e){return Boolean(e&&void 0!==e.length)}function r(){}function i(e){if(!(this instanceof i))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],f(e,this)}function o(n,r){for(;3===n._state;)n=n._value;0!==n._state?(n._handled=!0,i._immediateFn(function(){var e,t=1===n._state?r.onFulfilled:r.onRejected;if(null!==t){try{e=t(n._value)}catch(e){return void c(r.promise,e)}a(r.promise,e)}else(1===n._state?a:c)(r.promise,n._value)})):n._deferreds.push(r)}function a(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof i)return t._state=3,t._value=e,void l(t);if("function"==typeof n)return void f((r=n,o=e,function(){r.apply(o,arguments)}),t)}t._state=1,t._value=e,l(t)}catch(e){c(t,e)}var r,o}function c(e,t){e._state=2,e._value=t,l(e)}function l(e){2===e._state&&0===e._deferreds.length&&i._immediateFn(function(){e._handled||i._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)o(e,e._deferreds[t]);e._deferreds=null}function s(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function f(e,t){var n=!1;try{e(function(e){n||(n=!0,a(t,e))},function(e){n||(n=!0,c(t,e))})}catch(e){if(n)return;n=!0,c(t,e)}}i.prototype.catch=function(e){return this.then(null,e)},i.prototype.then=function(e,t){var n=new this.constructor(r);return o(this,new s(e,t,n)),n},i.prototype.finally=e,i.all=function(t){return new i(function(o,i){if(!u(t))return i(new TypeError("Promise.all accepts an array"));var a=Array.prototype.slice.call(t);if(0===a.length)return o([]);var c=a.length;for(var e=0;e<a.length;e++)!function t(n,e){try{if(e&&("object"==typeof e||"function"==typeof e)){var r=e.then;if("function"==typeof r)return void r.call(e,function(e){t(n,e)},i)}a[n]=e,0==--c&&o(a)}catch(e){i(e)}}(e,a[e])})},i.allSettled=t,i.resolve=function(t){return t&&"object"==typeof t&&t.constructor===i?t:new i(function(e){e(t)})},i.reject=function(n){return new i(function(e,t){t(n)})},i.race=function(o){return new i(function(e,t){if(!u(o))return t(new TypeError("Promise.race accepts an array"));for(var n=0,r=o.length;n<r;n++)i.resolve(o[n]).then(e,t)})},i._immediateFn="function"==typeof setImmediate?function(e){setImmediate(e)}:function(e){n(e,0)},i._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)};var p=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==d)return d;throw new Error("unable to locate global object")}();"function"!=typeof p.Promise?p.Promise=i:p.Promise.prototype.finally?p.Promise.allSettled||(p.Promise.allSettled=t):p.Promise.prototype.finally=e}()});var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};var o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function c(e,a,c,u){return new(c=c||Promise)(function(n,t){function r(e){try{i(u.next(e))}catch(e){t(e)}}function o(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?n(e.value):((t=e.value)instanceof c?t:new c(function(e){e(t)})).then(r,o)}i((u=u.apply(e,a||[])).next())})}function u(n,r){var o,i,a,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,i&&(a=2&t[0]?i.return:t[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,t[1])).done)return a;switch(i=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return c.label++,{value:t[1],done:!1};case 5:c.label++,i=t[1],t=[0];continue;case 7:t=c.ops.pop(),c.trys.pop();continue;default:if(!(a=0<(a=c.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){c=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){c.label=t[1];break}if(6===t[0]&&c.label<a[1]){c.label=a[1],a=t;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(t);break}a[2]&&c.ops.pop(),c.trys.pop();continue}t=r.call(n,c)}catch(e){t=[6,e],i=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}}var n=e(function(e){var r=Object.prototype.hasOwnProperty,d="~";function n(){}function i(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function o(e,t,n,r,o){if("function"!=typeof n)throw new TypeError("The listener must be a function");o=new i(n,r||e,o),t=d?d+t:t;return e._events[t]?e._events[t].fn?e._events[t]=[e._events[t],o]:e._events[t].push(o):(e._events[t]=o,e._eventsCount++),e}function u(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function t(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(d=!1)),t.prototype.eventNames=function(){var e,t,n=[];if(0===this._eventsCount)return n;for(t in e=this._events)r.call(e,t)&&n.push(d?t.slice(1):t);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},t.prototype.listeners=function(e){var e=d?d+e:e,t=this._events[e];if(!t)return[];if(t.fn)return[t.fn];for(var n=0,r=t.length,o=new Array(r);n<r;n++)o[n]=t[n].fn;return o},t.prototype.listenerCount=function(e){e=d?d+e:e,e=this._events[e];return e?e.fn?1:e.length:0},t.prototype.emit=function(e,t,n,r,o,i){var a=d?d+e:e;if(!this._events[a])return!1;var c,u=this._events[a],l=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),l){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,n),!0;case 4:return u.fn.call(u.context,t,n,r),!0;case 5:return u.fn.call(u.context,t,n,r,o),!0;case 6:return u.fn.call(u.context,t,n,r,o,i),!0}for(p=1,c=new Array(l-1);p<l;p++)c[p-1]=arguments[p];u.fn.apply(u.context,c)}else for(var s,f=u.length,p=0;p<f;p++)switch(u[p].once&&this.removeListener(e,u[p].fn,void 0,!0),l){case 1:u[p].fn.call(u[p].context);break;case 2:u[p].fn.call(u[p].context,t);break;case 3:u[p].fn.call(u[p].context,t,n);break;case 4:u[p].fn.call(u[p].context,t,n,r);break;default:if(!c)for(s=1,c=new Array(l-1);s<l;s++)c[s-1]=arguments[s];u[p].fn.apply(u[p].context,c)}return!0},t.prototype.on=function(e,t,n){return o(this,e,t,n,!1)},t.prototype.once=function(e,t,n){return o(this,e,t,n,!0)},t.prototype.removeListener=function(e,t,n,r){e=d?d+e:e;if(!this._events[e])return this;if(!t)return u(this,e),this;var o=this._events[e];if(o.fn)o.fn!==t||r&&!o.once||n&&o.context!==n||u(this,e);else{for(var i=0,a=[],c=o.length;i<c;i++)(o[i].fn!==t||r&&!o[i].once||n&&o[i].context!==n)&&a.push(o[i]);a.length?this._events[e]=1===a.length?a[0]:a:u(this,e)}return this},t.prototype.removeAllListeners=function(e){return e?(e=d?d+e:e,this._events[e]&&u(this,e)):(this._events=new n,this._eventsCount=0),this},t.prototype.off=t.prototype.removeListener,t.prototype.addListener=t.prototype.on,t.prefixed=d,t.EventEmitter=t,e.exports=t}).EventEmitter,i=["interactive","complete"],a=function(n,r){return new Promise(function(e){n&&"function"!=typeof n&&(r=n,n=null),r=r||window.document;function t(){return e(void(n&&setTimeout(n)))}-1!==i.indexOf(r.readyState)?t():r.addEventListener("DOMContentLoaded",t)})};a.resume=function(t){return function(e){return a(t).then(function(){return e})}};var l=[],s=[];function f(e,t){if(t=t||{},void 0===e)throw new Error("insert-css: You need to provide a CSS string. Usage: insertCss(cssString[, options]).");var n,r=!0===t.prepend?"prepend":"append",o=void 0!==t.container?t.container:document.querySelector("head"),t=l.indexOf(o);return-1===t&&(t=l.push(o)-1,s[t]={}),void 0!==s[t]&&void 0!==s[t][r]?n=s[t][r]:(n=s[t][r]=((t=document.createElement("style")).setAttribute("type","text/css"),t),"prepend"==r?o.insertBefore(n,o.childNodes[0]):o.appendChild(n)),65279===e.charCodeAt(0)&&(e=e.substr(1,e.length)),n.styleSheet?n.styleSheet.cssText+=e:n.textContent+=e,n}var p=f;p.insertCss=f;function h(e){return new y(e)}function m(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}function y(e){if(!(this instanceof y))return new y(e);(e=e||{}).nodeType&&(e={el:e}),this.opts=e,this.el=e.el||document.body,"object"!=typeof this.el&&(this.el=document.querySelector(this.el))}y.prototype.add=function(e){var t=this.el;if(t){if(""===t.className)return t.className=e;var n=t.className.split(" ");return-1<m(n,e)?n:(n.push(e),t.className=n.join(" "),n)}},y.prototype.remove=function(e){var t=this.el;if(t&&""!==t.className){var n=t.className.split(" "),e=m(n,e);return-1<e&&n.splice(e,1),t.className=n.join(" "),n}},y.prototype.has=function(e){var t=this.el;if(t)return-1<m(t.className.split(" "),e)},y.prototype.toggle=function(e){this.el&&(this.has(e)?this.remove(e):this.add(e))};var b,v=e(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ERR_IFRAME_ALREADY_ATTACHED_TO_DOM=t.ERR_NOT_IN_IFRAME=t.ERR_CONNECTION_TIMEOUT=t.ERR_CONNECTION_DESTROYED=void 0;var b="handshake",v="handshake-reply",d="reply",h="fulfilled",l="rejected",g="message",w="ConnectionDestroyed";t.ERR_CONNECTION_DESTROYED=w;var _="ConnectionTimeout";t.ERR_CONNECTION_TIMEOUT=_;var r="NotInIframe";t.ERR_NOT_IN_IFRAME=r;var o="IframeAlreadyAttachedToDom";t.ERR_IFRAME_ALREADY_ATTACHED_TO_DOM=o;function O(){if(P.debug){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];(e=console).log.apply(e,["[Penpal]"].concat(n))}}function k(e){var t=[];return e(function(){t.forEach(function(e){e()})}),{then:function(e){t.push(e)}}}function s(e){return{name:e.name,message:e.message,stack:e.stack}}function E(e,t,n,o,r){var l=t.localName,s=t.local,f=t.remote,p=t.remoteOrigin,i=!1;function a(u){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(O("".concat(l,": Sending ").concat(u,"() call")),f.closed&&o(),i){var r=new Error("Unable to send ".concat(u,"() call due ")+"to destroyed connection");throw r.code=w,r}return new P.Promise(function(o,i){function a(e){var t,n,r;e.source===f&&e.origin===p&&e.data.penpal===d&&e.data.id===c&&(O("".concat(l,": Received ").concat(u,"() reply")),s.removeEventListener(g,a),t=e.data.returnValue,e.data.returnValueIsError&&(n=t,r=new Error,Object.keys(n).forEach(function(e){return r[e]=n[e]}),t=r),(e.data.resolution===h?o:i)(t))}var c=m();s.addEventListener(g,a),f.postMessage({penpal:"call",id:c,methodName:u,args:t},p)})}}O("".concat(l,": Connecting call sender")),r.then(function(){i=!0}),n.reduce(function(e,t){return e[t]=a(t),e},e)}function $(e,n,t){var i=e.localName,r=e.local,a=e.remote,c=e.remoteOrigin,u=!1;function o(e){var r,t,o;e.source===a&&e.origin===c&&"call"===e.data.penpal&&(e=e.data,r=e.methodName,t=e.args,o=e.id,O("".concat(i,": Received ").concat(r,"() call")),r in n&&(e=function(n){return function(e){if(O("".concat(i,": Sending ").concat(r,"() reply")),u)O("".concat(i,": Unable to send ").concat(r,"() reply due to destroyed connection"));else{var t={penpal:d,id:o,resolution:n,returnValue:e};n===l&&e instanceof Error&&(t.returnValue=s(e),t.returnValueIsError=!0);try{a.postMessage(t,c)}catch(e){throw"DataCloneError"===e.name&&a.postMessage({penpal:d,id:o,resolution:l,returnValue:s(e),returnValueIsError:!0},c),e}}}},new P.Promise(function(e){return e(n[r].apply(n,t))}).then(e(h),e(l))))}O("".concat(i,": Connecting call receiver")),r.addEventListener(g,o),t.then(function(){u=!0,r.removeEventListener(g,o)})}var n,i={"http:":"80","https:":"443"},a=/^(https?:|file:)?\/\/([^/:]+)?(:(\d+))?/,P={ERR_CONNECTION_DESTROYED:w,ERR_CONNECTION_TIMEOUT:_,ERR_NOT_IN_IFRAME:r,ERR_IFRAME_ALREADY_ATTACHED_TO_DOM:o,Promise:function(){try{return window?window.Promise:null}catch(e){return null}}(),debug:!1},m=(n=0,function(){return++n});P.connectToChild=function(e){var l,t=e.url,s=e.appendTo,f=e.iframe,n=e.methods,p=void 0===n?{}:n,d=e.timeout;if(f&&f.parentNode){e=new Error("connectToChild() must not be called with an iframe already attached to DOM");throw e.code=o,e}var h=new k(function(e){l=e}),m=window,y=function(e){var t,n,r=document.location,e=a.exec(e),r=e?(t=e[1]||r.protocol,n=e[2],e[4]):(t=r.protocol,n=r.hostname,r.port);if("file:"===t)return"null";r=r&&r!==i[t]?":".concat(r):"";return"".concat(t,"//").concat(n).concat(r)}((f=f||document.createElement("iframe")).src=t);return{promise:new P.Promise(function(r,t){var o;void 0!==d&&(o=setTimeout(function(){var e=new Error("Connection to child timed out after ".concat(d,"ms"));e.code=_,t(e),l()},d));function n(e){var t,n=f.contentWindow;e.source===n&&e.origin===y&&e.data.penpal===b&&(O("Parent: Received handshake, sending reply"),t="null"===e.origin?"*":e.origin,e.source.postMessage({penpal:v,methodNames:Object.keys(p)},t),n={localName:"Parent",local:m,remote:n,remoteOrigin:t},a&&a(),t=new k(function(e){h.then(e),a=e}),$(n,p,t),i&&i.forEach(function(e){delete c[e]}),i=e.data.methodNames,E(c,n,i,l,h),clearTimeout(o),r(c))}var i,a,c={};m.addEventListener(g,n),O("Parent: Loading iframe"),(s||document.body).appendChild(f);var u=setInterval(function(){document.body.contains(f)||(clearInterval(u),l())},6e4);h.then(function(){f.parentNode&&f.parentNode.removeChild(f),m.removeEventListener(g,n),clearInterval(u);var e=new Error("Connection destroyed");e.code=w,t(e)})}),iframe:f,destroy:l}},P.connectToParent=function(){var a,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.parentOrigin,c=void 0===t?"*":t,t=e.methods,u=void 0===t?{}:t,n=e.timeout;if(window===window.top){e=new Error("connectToParent() must be called within an iframe");throw e.code=r,e}var l=new k(function(e){a=e}),s=window,f=s.parent;return{promise:new P.Promise(function(r,t){var o;void 0!==n&&(o=setTimeout(function(){var e=new Error("Connection to parent timed out after ".concat(n,"ms"));e.code=_,t(e),a()},n));function i(e){var t,n;"*"!==c&&c!==e.origin||e.source!==f||e.data.penpal!==v||(O("Child: Received handshake reply"),s.removeEventListener(g,i),t={localName:"Child",local:s,remote:f,remoteOrigin:e.origin},n={},$(t,u,l),E(n,t,e.data.methodNames,a,l),clearTimeout(o),r(n))}s.addEventListener(g,i),l.then(function(){s.removeEventListener(g,i);var e=new Error("Connection destroyed");e.code=w,t(e)}),O("Child: Sending handshake"),f.postMessage({penpal:b,methodNames:Object.keys(u)},c)}),destroy:a}},t.default=P}),g=(b=v)&&b.__esModule&&Object.prototype.hasOwnProperty.call(b,"default")?b.default:b,w=(Object.defineProperty(_.prototype,"originalRows",{get:function(){return this.$meta.count_rows},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"acceptedRows",{get:function(){return this.$meta.count_rows_accepted||null},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"originalColumns",{get:function(){return this.$meta.count_columns||null},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"matchedColumns",{get:function(){return this.$meta.count_columns_matched||null},enumerable:!1,configurable:!0}),_);function _(e){this.$meta=e}var O=(Object.defineProperty(k.prototype,"id",{get:function(){return this.$user.id},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"userId",{get:function(){return this.$user.userId},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"name",{get:function(){return this.$user.name},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"email",{get:function(){return this.$user.name},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"companyName",{get:function(){return this.$user.companyName},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"companyId",{get:function(){return this.$user.companyId},enumerable:!1,configurable:!0}),k);function k(e){this.$user=e}var E=(Object.defineProperty($.prototype,"id",{get:function(){return this.$file.id},enumerable:!1,configurable:!0}),Object.defineProperty($.prototype,"filename",{get:function(){return this.$file.filename},enumerable:!1,configurable:!0}),Object.defineProperty($.prototype,"filesize",{get:function(){return this.$file.filesize},enumerable:!1,configurable:!0}),Object.defineProperty($.prototype,"filetype",{get:function(){return this.$file.filetype},enumerable:!1,configurable:!0}),Object.defineProperty($.prototype,"url",{get:function(){return this.$file.url},enumerable:!1,configurable:!0}),$);function $(e){this.$file=e}var P=(Object.defineProperty(C.prototype,"rawOutput",{get:function(){return this.$data},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"data",{get:function(){return this.validData},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"validData",{get:function(){return this.$data.filter(function(e){return e.valid}).filter(function(e){return!e.deleted}).map(function(e){return e.data})},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"deletedData",{get:function(){return this.$data.filter(function(e){return e.deleted}).map(function(e){return e.data})},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"allData",{get:function(){return this.$data.map(function(e){return e.data})},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"remainingChunks",{get:function(){return Math.ceil((this.totalChunks-this.currentChunk)/this.$meta.inChunks)},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"totalChunks",{get:function(){return Math.ceil(this.$meta.count_rows_accepted/this.$meta.inChunks)},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"chunkSize",{get:function(){return this.$meta.inChunks},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"currentChunk",{get:function(){return(this.$meta.pointer+this.chunkSize)/this.chunkSize},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"hasMore",{get:function(){return this.$meta.hasMore},enumerable:!1,configurable:!0}),C);function C(e,t){this.$meta=t,this.$data=e}var j=(Object.defineProperty(T.prototype,"rawOutput",{get:function(){return this.blobOnly(this.$data,"rawOutput")},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"data",{get:function(){return this.blobOnly(this.validData,"data")},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"validData",{get:function(){var e=this.$data.filter(function(e){return e.valid}).filter(function(e){return!e.deleted}).map(function(e){return e.data});return this.blobOnly(e,"validData")},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"deletedData",{get:function(){var e=this.$data.filter(function(e){return e.deleted}).map(function(e){return e.data});return this.blobOnly(e,"deletedData")},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"allData",{get:function(){return this.blobOnly(this.$data.map(function(e){return e.data}),"allData")},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"batchId",{get:function(){return this.$meta.batchID},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"stats",{get:function(){return new w(this.$meta)},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"customer",{get:function(){return this.$meta.endUser?new O(this.$meta.endUser):null},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"originalFile",{get:function(){return this.$meta.originalFile?new E(this.$meta.originalFile):null},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"csvFile",{get:function(){if(this.$meta.originalFile){if("csv"===this.$meta.originalFile.filetype)return new E(this.$meta.originalFile);if(this.$meta.csvFile)return new E(this.$meta.csvFile)}return null},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"fileName",{get:function(){return this.$meta.filename||null},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"managed",{get:function(){return this.$meta.managed||!1},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"manual",{get:function(){return this.$meta.manual},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"config",{get:function(){return this.$meta.config},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"parsingConfig",{get:function(){return this.$meta.parsing_config},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"skippedRows",{get:function(){return this.$meta.skipped_rows||null},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"headersRaw",{get:function(){return this.$meta.headers_raw||null},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"headersMatched",{get:function(){return this.$meta.headers_matched||null},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"customColumns",{get:function(){return this.$meta.custom_columns},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"categoryFieldMap",{get:function(){return this.$meta.category_field_map||null},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"failureReason",{get:function(){return this.$meta.failure_reason||null},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"submittedAt",{get:function(){return this.$meta.submitted_at||null},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"failedAt",{get:function(){return this.$meta.failed_at||null},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"createdAt",{get:function(){return this.$meta.created_at},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"stylesheet",{get:function(){return this.$meta.stylesheet},enumerable:!1,configurable:!0}),T.prototype.blobOnly=function(e,t,n){if(void 0===n&&(n="nextChunk()"),this.$meta.inChunks)throw new Error('"'+t+'" is not accessible when using "inChunks". Please see docs for "'+n+'" instead.');return e},T.prototype.nextChunk=function(){var n=this;return new Promise(function(t,e){if(!n.$meta.inChunks)return e('"nextChunk()" is only accessible when using "inChunks". Please see docs for "requestDataFromUser".');n.$importer.$ready.then(function(e){console.log("child.nextChunk()"),e.nextChunk().then(function(e){console.log("nextChunk()",e),t(e.results.length?new P(e.results,e.meta):null)},function(e){console.log("nextChunk(err)",e)})})})},T);function T(e,t,n){this.$meta=t,this.$data=e,this.$importer=n}var N,n=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(R,N=n),R.setMountUrl=function(e){this.MOUNT_URL=e},R.setVersion=function(e){switch(e){case 1:this.MOUNT_URL="https://kiosk-lite.flatfile.io/?key=:key";break;case 2:this.MOUNT_URL="https://portal-2.flatfile.io/?key=:key";break;default:throw new Error(e+" is not a valid version")}},R.prototype.open=function(n){var r=this;void 0===n&&(n={}),n=o(o({},n),{bulkInit:!0,hasRecordHook:!!this.$recordHook,hasInteractionEventCallback:!!this.$interactionEventCallback,stepHooks:Object.keys(this.$stepHooks),fieldHooks:this.$fieldHooks.map(function(e){return e.field}),endUser:this.customer}),this.$ready.then(function(e){h(document.body).add("flatfile-active");var t=document.getElementById("flatfile-"+r.uuid);t&&(t.style.display="block"),e.open(n)})},R.prototype.load=function(){var i=this;return new R.Promise(function(t,n){i.open();var r=function(){i.removeListener("close",o),i.removeListener("complete",e)};function e(e){t(e),r()}function o(e){n(e),r()}i.on("close",o),i.on("complete",e)})},R.prototype.requestDataFromUser=function(e){return void 0===e&&(e={}),this.open(o(o({},e),{inChunks:e.inChunks||null,expectsExpandedResults:!0})),this.responsePromise()},R.prototype.displayLoader=function(t){this.$ready.then(function(e){e.displayLoader(t)})},R.prototype.displayError=function(t){this.$ready.then(function(e){e.displayError(t)})},R.prototype.requestCorrectionsFromUser=function(t,n){return this.$ready.then(function(e){e.displayError(t,n)}),this.responsePromise()},R.prototype.displaySuccess=function(t){var n=this;return this.$ready.then(function(e){e.displaySuccess(t)}),new Promise(function(e){var t=function(){e(),n.removeListener("close",t)};n.on("close",t)})},R.prototype.setCustomer=function(e){this.customer=e},R.prototype.setLanguage=function(t){this.$ready.then(function(e){e.setLanguage(t)})},R.prototype.addVirtualField=function(t,n){void 0===n&&(n={}),this.$ready.then(function(e){e.addVirtualField({field:t,options:n})})},R.prototype.registerRecordHook=function(e){this.$recordHook=e},R.prototype.registerNetworkErrorCallback=function(e){this.$networkErrorCallback=e},R.prototype.registerBeforeFetchCallback=function(e){this.$beforeFetchCallback=e},R.prototype.registerInteractionEventCallback=function(e){this.$interactionEventCallback=e},R.prototype.registerFieldHook=function(e,t){this.$fieldHooks.push({field:e,cb:t})},R.prototype.registerStepHook=function(e,t){this.$stepHooks[e]=t},R.prototype.close=function(){this.$ready.then(function(e){e.close()})},R.prototype.handleClose=function(){h(document.body).remove("flatfile-active");var e=document.getElementById("flatfile-"+this.uuid);e&&(e.style.display="none")},R.prototype.initialize=function(){var i=this;p("\n      .flatfile-component {\n        position: fixed;\n        top: 0;\n        bottom: 0;\n        right: 0;\n        left: 0;\n        display: none;\n        z-index: 100000;\n      }\n      .flatfile-component iframe {\n        width: 100%;\n        height: 100%;\n        position: absolute;\n        border-width: 0;\n      }\n      body.flatfile-active {\n        overflow: hidden;\n        overscroll-behavior-x: none;\n      }\n    "),document.body.insertAdjacentHTML("beforeend",'<div id="flatfile-'+this.uuid+'" class="flatfile-component"></div>');var e=setTimeout(function(){return console.error("[Flatfile] Looks like Portal takes too long to load. Please visit our Help Center (https://help.flatfile.io/support/solutions/articles/64000263381-my-importer-isn-t-loading) or contact Flatfile support for any help.")},5e3);this.handshake=g.connectToChild({appendTo:document.getElementById("flatfile-"+this.uuid)||void 0,url:R.MOUNT_URL.replace(":key",this.apiKey),methods:{results:function(e){i.emit("results",e.results,e.meta)},complete:function(e){i.emit("complete",e.rows,e.meta)},close:function(){i.emit("close"),i.handleClose()},networkErrorCallback:function(e){return i.$networkErrorCallback?i.$networkErrorCallback(e):void 0},beforeFetchCallback:function(e){return i.$beforeFetchCallback?i.$beforeFetchCallback(e):void 0},interactionEventCallback:function(e){return i.$interactionEventCallback?i.$interactionEventCallback(e):void 0},dataHookCallback:function(t,n,r){try{return i.$recordHook?i.$recordHook(t,n,r):void 0}catch(e){e.message;var o=e.stack;return console.error("Flatfile Record Hook Error on row "+n+":\n  "+o,{row:t,mode:r}),{}}},bulkHookCallback:function(e,r){try{return i.$recordHook?Promise.all(e.map(function(e){var t=e[0],n=e[1];try{return i.$recordHook(t,n,r)}catch(e){throw e.row=t,e.index=n,e}})):void 0}catch(e){var t=e.stack,n=e.row,o=e.index;return console.error("Flatfile Record Hook Error on row "+o+":\n  "+t,{row:n,mode:r}),{}}},fieldHookCallback:function(t,n){var e=i.$fieldHooks.find(function(e){return e.field===n.field});if(e)try{return e.cb(t,n)}catch(e){var r=e.stack;return console.error('Flatfile Field Hook Error on field "'+n.field+'":\n  '+r,{meta:n,values:t}),[]}},stepHookCallback:function(n,r){return c(i,void 0,void 0,function(){var t;return u(this,function(e){switch(e.label){case 0:if(!this.$stepHooks[n])return[2,void 0];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.$stepHooks[n](r)];case 2:return[2,e.sent()];case 3:return t=e.sent(),t=t.stack,console.error('Flatfile Step Hook Error on step "'+n+'":\n  '+t,{payload:r}),[3,4];case 4:return[2]}})})},ready:function(){return i.handshake.promise.then(function(e){i.$resolver(e),i.customer&&e.setUser(i.customer)}).catch(function(e){console.error(e)}),i.options}}}),this.handshake.promise.then(function(){e&&clearTimeout(e)}),this.handshake.promise.catch(function(e){i.$rejecter(e)})},R.prototype.$generateUuid=function(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)},R.prototype.responsePromise=function(){var a=this;return new Promise(function(o,t){var e=function(n,r){return c(a,void 0,void 0,function(){var t;return u(this,function(e){return t=new j(n,r,this),o(t),i(),[2]})})};function n(e){t(e),i()}var r=a;function i(){r.removeListener("close",n),r.removeListener("results",e)}a.on("close",n),a.on("results",e)})},R.Promise=Promise,R.MOUNT_URL="https://portal-2.flatfile.io/?key=:key",R);function R(e,t,n){var r=N.call(this)||this;return r.$fieldHooks=[],r.$stepHooks={},r.apiKey=e,r.options=t,r.customer=n,r.uuid=r.$generateUuid(),r.$ready=new R.Promise(function(e,t){r.$resolver=e,r.$rejecter=t}),a(function(){r.initialize()}),r}return"object"==typeof document&&"function"!=typeof document.contains&&(Object.getPrototypeOf(document).contains=t),n}();